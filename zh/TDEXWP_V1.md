# TDEX：利用原子交换实现去信任金融的去中心化愿景

**TDEX 白皮书 | 版本 1.1 | 2022 年 6 月**

**摘要**：T(True)DEX 是第一个在液态网络上构建的基于原子交换并以隐私优先的去中心化交易所 (DEX) 项目。作为一个面向社区的开源项目，它旨在成为可为比特币用户以及流动资产的二级市场提供快速安全的网络空间的框架。在此过程中，TDEX 利用比特币的安全性促进了流动性的产生，但大幅缓解了其隐私性和可替代性的缺陷，从而加强了去信任金融的基础。在本白皮书中，我们将详细阐述此项目的生态系统以及闪耀着指引之光的潜在愿景。

## 1. 简介

技术创新是人类进步的关键，它们往往拯救和改善了人们的生活。考虑到技术的巨大意义，最理想的情况是每个人都能平等和充分地获得技术。然而，事实并非如此。

聚焦于金融领域，我们不能否认金融科技的创新极大地增强了整体最终用户体验：一键支付、数字存折、e-KYC 等等。然而，尽管人们认为获得的易用性推动了更广泛的使用，但实际上，传统金融系统在结构上排斥了全球约 [17 亿](https://globalfindex.worldbank.org/chapters/unbanked)无银行账户成年人。

另一方面，隐私遭受严重侵犯。政府机构和营利性公司不仅窥探用户的在线活动，还滥用他们的个人数据来监控、审查和宣传广告。可以说，这相当于侵犯了用户的一项最基本的权利。

首先，这是银行、政府、代理、经纪人等多个中介机构参与的直接结果。这些中介充当监督者或“信任者”的角色，并在此过程中成为控制的中心点。

### 1.1 比特币：结合面向用户的技术

中本聪在 2008 年发布了比特币[白皮书](https://nakamotoinstitute.org/bitcoin/)，介绍了四种*面向用户*的强大技术（区块链、密码学、工作量证明和点对点等），从某种意义上说，它们恢复了对用户的控制，而不是中心化的管理实体。这项创新为在分布式和完全去中心化的生态系统内进行安全点对点货币交易的新经济范例提供了便利。通过在不使用基于信任的模型的情况下解决重复支付问题，中本聪有效地将第三方中介从这一过程中剔除，并用计算机化的算法取代了它们。

然而，尽管拥有健全货币和价值储存的所有特征，比特币在其框架形式下却未能实现其隐私性和可替代性的承诺。换句话说，比特币交易是假名而非匿名的，而它的可替代性受到链分析等方面的挑战。此外，为了实现最佳的安全性和弹性，比特币的核心在可伸缩性方面做出了重大妥协，这使它在多种基于比特币的解决方案和功能上效率低下。在本文的后面，我们将探讨液态侧链如何解决比特币第一层存在的这些问题。

### 1.2 产生一致价值的问题

在过去的十年里，社区逐渐变得拥挤不堪，几乎充斥着各种加密资产。在颠覆性承诺的支持下，这些资产迅速流行起来。然而，考虑到欺诈、黑客攻击和失败项目造成的巨大损失，我们必须认真审视大多数的努力是否确实为社区的长期发展做出了贡献。更重要的是，它们在该领域的基本原则方面表现如何？

**托管型交易所**。为了与 TDEX 的直接目的保持一致，我们以中心化交易所为例，这是目前与大多数加密资产进行交互的主要网关。为了履行监管义务并确保流动性，大多数交易所平台都是托管型的：它们保留对用户资金的控制权以及交易所托管钱包的私钥。

大多数托管型交易所由单一实体拥有、管理和控制，而资金和数据则存储在中心化服务器中。因此，为了在这些交易所进行交易，用户必须与代表<em>单点失效</em>的谷仓式服务器交互，从而使他们暴露在安全和隐私泄露、审查以及资金损失的高风险之下。

**去中心化交易所**。作为托管型交易所的替代方案，一些去中心化交易所正在迅速激增。一般来说，他们实施算法做市协议，通常被称为<em>自动做市商</em>（即 AMM），通过供需指标来确定价格，不受第三方干预。但是，它们也带来了自己的一系列风险，其中可扩展性问题与本文中所述内容最为相关。

部分是因为它们的底层区块链，再加上实施智能合约所带来的缺点，大部分 DEX 不支持扩展，因此在网络拥堵期间会产生非常高的交易费用。在它们目前的形式下，随着 DEX 变得越来越流行，它也会变得愈加昂贵。此外，智能合约中的漏洞已成为该行业的普遍风险，会导致用户因黑客攻击和破坏行为而遭受重大损失。

### 1.3 TDEX 项目

由 SevenLabs 发起的 TDEX 是一个在液态网络上构建的面向社区、基于元素的去中心化交易所。利用比特币液态框架的安全性、易用性和速度的综合优势，TDEX 构想了一种快速、安全、真正去中心化的流动资产 (L-Assets) 交易体验。

底层的 TSWAP 协议实现了原子交换，并通过多种“0 到 1”激励机制解决了流动性问题。此外，TDEX 还通过允许流动性提供者选择自己的做市策略来为他们赋权。另一方面，交易者可以从有竞争力的汇率、更快的结算速度、更低的滑点和更好的安全性中受益。

在后面的部分中，我们将探讨 TDEX 项目的背景和前景元素。在此过程中，我们重点介绍该协议如何成为去信任金融的骨干网络，使专业交易者和企业所有者能够在以隐私优先的环境中进行管理、交易和投资。

## 2. 框架：安全性、隐私性和速度

利用基于元素的核心，TDEX 部署在液态网络上。作为比特币侧链，液态网络继承并增强了其安全性，同时提高了隐私性、可替代性和可扩展性。在本部分中，我们将阐述采用液态网络作为 TDEX 框架的根本原因。

为了有效解决上述去中心化交易的危机，TDEX 设想了一种整体的双重解决方案。一方面，它必须解决社区的一些原始问题，如延迟、隐私性不足以及对可替代性的威胁。另一方面，它必须拓宽开放金融解决方案的视野，实现可与比特币核心相比的更新功能。换句话说，TDEX 打算将比特币第一层的目的多样化，而在这一点上，它的愿景与液态网络（第二层比特币侧链）的愿景相符。

正如液态网络[白皮书](https://blockstream.com/assets/downloads/pdf/liquid-whitepaper.pdf)的作者正确指出的那样，*“对于加密货币交易者的高速世界而言，交易费用、结算时间差异、公开广播交易以及链重组的风险，可能会在他们的交易活动过程中产生大量成本。”*

除了我们将简要探讨的网络拜占庭容错 (BFT) 共识之外，诸如机密交易和资产发行等实现似乎最符合 TDEX 的目的。

### 2.1 强大联盟和液态网络的 BFT 共识

简单地说，液态网络采用一种“挂入挂出”的机制，由分布在*全球和文化*上的一组“工作人员”保护，共同组成一个验证者的“[强大联盟](https://blockstream.com/strong-federations.pdf)”。为了确保这些工作人员*参与其中*，协议要求他们是交易所、经纪人等等，也就是说，具有极大动力来确保比特币网络的稳定性和发展的实体。联盟使用“密钥模块”在液态网络上对区块、交易和*挂钩*签名，这些模块执行算法逻辑来限制未经授权的分叉和交易。此外，底层的 BFT 共识实现了*循环式三阶段提交方案*，每分钟都会对区块签名，而不涉及链重组的风险。

与比特币 PoW 共识的*随机泊松分布*不同，液态网络的联合双向挂钩意味着交易延迟的多方面改善。反过来，这将允许在 TDEX 网络上进行几乎实时的交易和交易结算（约 2 分钟），同时由于平台联盟是一组互不信任的参与者，因此还可以保留协议的去中心化。此外，液态网络采用了阈值向量，其中 *n* 是工作人员的总数，*k* 表示一个区块被视为有效所需的最小签名数。尽管缺点是每个工作人员都必须有一个足够同步的时钟，但上述向量使网络能够同时实现*安全性*和*实时性*，最终为 TDEX 带来更高的安全性和更长的正常运行时间。

### 2.2 机密交易

在开发 TDEX 的过程中，人们意识到隐私是一项基本人权，这本身已成为大多数选择的基础。比特币的公共账本记录了每一笔交易，而没有将它们直接链接到发送者，显然，这足以保护隐私。然而，仔细观察就会发现，在很大程度上，*使用假名*并不能确保用户的*自主权*。例如，*链分析*和跟踪与某个公钥相关的交易历史记录可以有效地消除用户的假名。此外，在这一过程中揭示的模式也可以用于区分*良币*和*劣币*，这对*可替代性*造成了威胁。目前正在开发解决方案来解决这些问题，其中包括 TDEX 实现。

必须注意的是，隐私不仅仅是*保密* – 准确地说，它意味着用户可以控制*是否以及何时*揭示有关自身的部分信息。在这方面，液态网络增强了比特币的隐私性指标，因此，它的路径再次与 TDEX 的旅程相交。

通过实现*同态承诺*、*迪菲-赫尔曼密钥交换*和*范围证明*等组件，液态网络可以实现“[机密交易](https://blockstream.com/bitcoin17-final41.pdf)”，其中金额和资产类型均处于盲状态。换句话说，正在交易的资产的数量和类型以这样一种方式加密：该资产既不能使用另一个值解密（打开），也不能在给定承诺的情况下确定。这种方法以*未花费的交易输出* (UTXO) 模型为前提，通过证明 _ **总输入 = 总输出** _（即在交易过程中未出现通货膨胀、破坏或重复支出的情况）来验证交易的有效性。此外，该网络还利用了零知识证明的一种形式 – *资产满射证明* (ASP)，简单地说，“*资产标签*”证明它已承诺用于一项*已花费资产*，但没有揭示是哪个资产。

作为液态网络机器中的主要齿轮，机密交易采用使用*盲密钥*（即私钥-公钥对）的非对称加密。除其他结果外，它最大限度地降低了密钥交换过程中被截获的风险，从而使交易具有最佳的私密性和抗审查性。简单地说，这个过程可以总结如下：

- 资产所有者（发送方），例如 Alice，为她打算进行的交易（交换）广播公开地址。可以理解，这对于整个网络都是可见的。
- 一个感兴趣的接收方，例如 Bob，*将她的公共盲密钥编码*为与 Alice 共享的地址。对于 TSWAP，这种交换通过一种加密的消息传递协议进行，该协议除了确保安全性外，还允许双方验证交易中涉及的 UTXO。
- 在收到消息后，Alice 建立交易并用 Bob 的公开地址将其加密。Bob（接收方）是唯一拥有该交易相关私钥的人，因此，只有在交易记录到区块链上之后，他才能解密该交易，甚至 Alice 也无法解密。

因此，该网络满足了全盘“透明”相当不可取的这类交易需求。例如，机密交易使企业能够以去中心化和可验证的方式进行金融流程，但同时又可以保护敏感信息不暴露于公众面前。同样，这一原则也增强了在其他相关部门（如政府财政等）采用比特币方案的动力。

## 3. TDEX 生态系统

最近，液态网络（Blockstream 的首席执行官 Adam Back 称其为液态金融或 LiFi）上出现的去中心化解决方案获得了巨大的优势。因此，网络上正在产生越来越多的价值，特别是以流动资产的形式。反过来，除了作为开源工具包来促进进一步创新之外，TDEX 还努力满足社区对这些资产的去中心化二级市场日益增长的需求。

在前面的部分中，我们探讨了 TDEX 的框架及其一些关键选择背后的原因。现在，我们详细介绍该协议的生态系统，为读者提供协议和实现的概述。

### 3.1 技术支柱：True DEX (BOTD) 的基本知识

TDEX 的核心存在四种协议 – *消息*、*传输、交换*和*交易*，我们将在本部分中探讨这些协议。但是，在这方面，本文有意避免阐述完整的技术说明，这些说明可在 [TDEX 规范](https://dev.tdex.network/docs/specs/index)下的技术文档中找到。

#### 3.1.1 消息协议：BOTD #1

对于 TDEX 的去中心化网络，一个基本的所谓原始需求是用于连接交易对方的安全双向消息传递通道。这样的连接必须可靠、稳定、点对点 (P2P)，并且首先要优先考虑隐私。利用液态网络，TDEX 可以满足*机密通信*的这些要求。此外，为了序列化这些消息，TDEX 实现了 Google 的*协议缓冲区* – 一种用于序列化结构化数据、与平台和语言无关的方法。

#### 3.1.2 传输协议：BOTD #2

为了在网络上进行交易，守护进程（用户）需要 P2P 传输通道，其中对机密性和安全性的要求与消息协议类似。在这方面，TDEX 提供了几个具有不同程度隐私性的选项，用户可以单独或组合实现这些选项 – *明文*（不安全）、*洋葱服务* (onion)、*服务器端 TLS* (TLS)、*相互 TLS* (mTLS) 和 *Noise_XK_secp256k1_ChaChaPoly_SHA256* (noise)。在加入 TDEX 网络时，用户必须声明其已实现的传输通道。

#### 3.1.3 交换协议：BOTD #3

TSWAP 协议是一种安全的、基于原子交换的实现，它允许网络上的对等方交换签名的消息和交易。作为连接**提议者**和**响应者**的桥梁，TSWAP 是 TDEX 生态系统中的一个关键元素。利用前面提到的消息和传输协议，TSWAP 主要包含四个子元素:

- **SwapRequest：****提**议者**发起交换。
- **SwapAccept：**响应者接受请求。
- **SwapComplete：**提议者确认安全连接。
- **SwapFail：**任何一方在失败时宣告交换终止。将来，可以实现一个附加元素 *failure_code* 来表示失败的原因。

#### 3.1.4 交易协议：BOTD #4

交易协议可以说是 TDEX 最关键的实现，它结合了以前的所有 BOTD 来定义非托管型交易所的公共接口。与托管型交易所的订单-账本模型相反，此协议允许*交易者*和*做市商*使用原子交换直接连接。

在后面的部分中，我们将探讨用户和流动性提供者的生态系统。目前，只要提到做市商代表*始终存在*的守护进程，并向**基础报价**资产对提供成比例的流动性便已足够。未来，TDEX 将采用以[简单性](https://blockstream.com/simplicity.pdf)为基础的合约，以进一步增强平台的安全性和隐私性，同时实现更丰富的功能。

### 3.2 适用于做市商的 TDEX

在 TDEX 网络中，*做市商*是为在交易所上交易的资产对提供流动性的实体，因此也可以称为*流动性提供者*（**提供者**）。提供者的主要职能是持有一对相互挂钩的报价资产 (quote_asset) 和基础资产 (base_asset)。不过，必须指出的是，这适用于任何资产对，不一定是与比特币挂钩的资产对。

作为[*需求的双重巧合*](https://www.oxfordreference.com/view/10.1093/oi/authority.20110803095622703)这一经典问题的解决方案，TDEX 使做市商能够*始终*在端点上运行，同时还可以使用 BOTD #2 中定义的任何一个通道揭示其公开可到达地址。这可确保为交易者提供随时可用的市场，从而解决了去中心化交易的一个主要痛点。

#### 3.2.1 守护进程实现

要以提供者身份参与，用户必须在网络上实现一个守护进程，要么通过 Docker，要么作为一个独立实体来运行它（阅读更多：[守护进程的实现过程](https://docs.tdex.network/tdex-daemon.html)）。TDEX 上的标准守护进程公开了两个 HTTP/2 gRPC 端点 – **交易者接口**（公共）和**操作员**接口（私有）。公共接口代表交易者的端口（默认值：9945），而私有接口（默认值：9000）用于做市商的内部交易。此外，为实现最佳安全性，每个守护进程都有一个预先嵌入的 [Blockstream Green](https://help.blockstream.com/hc/en-us/categories/900000056183-Blockstream-Green) 或液态钱包。

#### 3.2.2 做市策略

TDEX 的一个与众不同之处在于，它为提供者提供了多种做市选择，从而极大地拓宽了他们的范围。换句话说，TDEX 允许做市商选择或创建自己的策略，而不是强行实施其中一种策略。

默认情况下，该协议采用*常值函数做市* (CFMM) 策略来确定资产价格。不过，做市商也可以选择使用自定义 API 实现*可插拔*（外部）喂价。考虑到商业参与对于 TDEX 的成功至关重要，因此自定义做市策略是该平台最关键的功能之一，特别是因为它同时支持用户选择的逻辑。换句话说，提供者可以选择自己的定价策略，而平台的主权交易者则可以选择或拒绝这些策略。

#### 3.2.3 交换费用

尽管*基础资产-报价资产*准备金率会随着每笔交易而变化，但通过对每笔交易征收最低的交换费用并将其添加到准备金中， TDEX 可确保整体市场规模的一致性。考虑到套利有助于促进一致的交易流，在做市商实施基于 AMM 的策略的情况下，该费用所产生的收入将随着时间的推移而增加。

但同时，TDEX 采用 [P2EP](https://en.bitcoin.it/wiki/PayJoin) [机制](https://en.bitcoin.it/wiki/PayJoin)，这最大程度地减小了交易所需的区块链空间，从而有效地优化所涉及的费用。这样做是为了确保协议上的交易者和提供者都能拥有一个公平、公正的赛场。

#### 3.2.4 流动性池（未来实现）

随着沿预期的路线图进一步发展，TDEX 将实现一个*非托管*功能，可以充当守护进程连接在一起并池化其资产的框架。一旦实现，便可确保协议上更大、更一致的流动性，并为用户提供方便的单一端点。反过来，TDEX 将能够大规模地满足金融需求。

这样一来，创建池的提供者将成为*池主*，而其他提供者将能够加入*分布式服务网格*以聚合流动性。作为奖励，池主将被授予确定池资产基础价格的能力，而交易者将必须查询提供者的聚合现货价格。对于任何给定的资产，提供者既可以单独运行，也可以加入池，但他们不能同时担任这两个职务。

### 3.3 适用于交易者的 TDEX

在 TDEX 的背景下，*市场*是可以进行原子交换的任何一对基础和报价资产。如在 BOTD #3 中所述，**提议者**必须在 TDEX 上发起交换，并且在网络上代表交易者。换句话说，TDEX 上的交易者是完全实现交易协议 (BOTD #4) 的任何用户。在此过程中，她会与前面探讨过的交易者接口（提供者的守护进程的公共端口）相连，并同意按规定的市场价格进行交易。

一般而言，TDEX 上的交易类似于任何其他基于原子交换的交易所，这意味着交易者可以按同等比例（按市值）交换这对资产中的两种资产。但是，与其他网络的大多数同行不同，TDEX 的框架可确保机密性、更快的结算速度以及最小或无滑点。此外，由于 TDEX 是非托管的，因此交易者不必担心会因黑客攻击和破坏行为而损失资金。

#### 3.3.1 软件开发工具包：TDEX 对 LiFi 的开源贡献

除了默认 UI 外，该协议还允许用户使用 TDEX 的软件开发工具包 (SDK) 部署他们的自定义客户端。在初始阶段，这可以使用 [JavaScript](https://docs.tdex.network/tdex-sdk.html) 完成，但在将来，TDEX 会提供适用于 Python、Go 和 Rust 的 SDK。另一方面，在初始阶段，交易者使用[命令行接口](https://docs.tdex.network/tdex-sdk.html) (CLI) 与提供者交互，直到去中心化移动应用程序的未来计划实现。

从本质上说，这些 SDK 代表了 TDEX 对网络开源功能的贡献，主要是通过为精通比特币 API 实现和其他类似功能的开发者赋权。在这方面，更广泛的愿景是在流动性生态系统内推动创新，特别是旨在加强网络上的流动性募资。

### 3.4 用例

在探讨了 TDEX 生态系统的各种元素之后，现在让我们看一些显著的和可能的用例。

#### 3.4.1 流动资产的二级市场

一般而言，必须记住，在 TDEX 网络上交易的资产本质上是流动资产。因此，成为流动资产的二级市场是 TDEX 平台的主要用例之一，至少在初始阶段如此。

简而言之，液态网络允许其用户“发行”跨资产类别的可转让资产 – 包括代币化的法币和其他非 BTC 加密货币、不可替代的代币（收藏品）、激励代币（奖励）、代币化商品（例如金币）等等。每个流动资产都有一个 64 字符的标识符，通过在 Blockstream.info 的“资产注册”上（即液态网络版本的区块浏览器上）发布它们的元数据，可以将其附加到区块链上人类可读的域。此外，该协议还允许重新发行代币和代币销毁。在 TDEX 的背景下，这意味着提供者可以为任何一对流动资产创建市场，从而促进这些资产的交易。同样，它也可以用于非同质化代币的交易和销售。

不过在这一点上，必须注意 TDEX 愿景的一个关键方面 – TDEX 不应具有本地代币，这主要是因为该项目是面向社区的，并且不优先考虑任何盈利动机。

#### 3.4.2 机构交易和资金转移

TDEX 网络上的用户和做市商不一定是个人，也可以是机构和企业。因此，该平台为此类组织提供了一个安全的渠道来交易流动资产，反过来，这类组织又应在促进长期采用和拓展社区方面起到决定性的作用。

除此之外，通过帮助小型、中型和大型企业确立以去中心化方式部署自定义解决方案来满足其金融需求的可能性，TDEX 的开源工具包还进一步拓宽了范围。事实上，正是在这个意义上，TDEX 成为去信任金融“骨干网络”的目标才得以实现。

## 4. 结论

对隐私性和安全性的担忧如雨后春笋般涌现。合规性义务以多种方式削弱了中心化交易所，而去中心化交易所则在安全性方面做出了妥协，并成为猖獗的黑客、欺诈和各种破坏行为的牺牲品。最终，在这些因素的共同作用下，用户要么失去了金钱，要么失去了数据，更重要的是，他们被剥夺了基本的隐私权和自主权。

在这种背景下开发的 TDEX 是一种在液态网络上部署的以隐私优先的去中心化协议。该平台主要是一种基于原子交换的交易协议。此外，它还具有一个开源工具包，开发者可以使用该工具包在网络上部署自定义 API 和其他解决方案。总体而言，TDEX 预想成为一个骨干协议，以便推动液态网络上的去中心化解决方案的发展，进而加强去信任金融的基础，为全球比特币用户和爱好者社区打造一个安全、可靠的精英化空间。

## 致谢

在踏上迈向未来的旅程时，TDEX 受到了许多人和公司的启发、指导和帮助。我们意识到，没有他们，这个项目将永远无法实现，因此我们要向众多贡献者致以诚挚的谢意。

[Blockstream](https://blockstream.com/)

[Vulpem Ventures](https://vulpem.com/)

[Mohammad Musharraf](http://mohammadmusharraf.com/)

[Shiladitya Sinha](https://www.linkedin.com/in/shiladityasinhaofficial/)

最重要的是，感谢中本聪
